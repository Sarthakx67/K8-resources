# Deployment manifest for nginx
# - Creates a ReplicaSet that ensures the desired number of Pod replicas are running.
# - Use Deployments to perform rolling updates, rollbacks, and scale replicas.
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment    # logical name for the Deployment object
  labels:
    app: nginx              # top-level labels can be used to select this Deployment
    environment: dev
spec:
  replicas: 3               # desired number of Pod replicas (ReplicaSet will maintain this)
  selector:
    matchLabels:
      app: nginx            # selector must match the labels defined in template.metadata.labels
      environment: dev
      componet: frontend
  template:
    metadata:
      labels:
        app: nginx          # labels applied to Pods created by this Deployment
        environment: dev
        componet: frontend
    spec:
      containers:
      - name: nginx
        image: nginx        # container image (no tag => 'latest' by default; consider pinning a tag for reproducibility)
        ports:
        - containerPort: 80 # port exposed by the container (containerPort is informational for Kubernetes and used in port mappings)
# Notes:
# - The Deployment creates a ReplicaSet which in turn creates Pods using the template above.
# - Changing spec.template (e.g., image) triggers a rolling update by default.
# - Ensure selector.matchLabels exactly equals template.metadata.labels; mismatch prevents the Deployment from managing the Pods.
# - For production, add resources.requests/limits and imagePullPolicy, and pin the image tag.


# Important kubectl commands (run with -n roboshop if using that namespace):

# - Apply/update manifest:
#   kubectl apply -f d:\kubernetes\k8-resources\sets\02-deployment.yaml -n roboshop
# - Describe deployment:
#   kubectl describe deployment nginx-deployment -n roboshop
# - List deployments:
#   kubectl get deployments -n roboshop
# - List pods for this app:
#   kubectl get pods -l app=nginx -n roboshop
# - Delete a pod (Deployment will recreate):
#   kubectl delete pod <pod-name> -n roboshop
# - Delete pods by label:
#   kubectl delete pods -l componet=frontend -n roboshop
# - Trigger rolling restart:
#   kubectl rollout restart deployment/nginx-deployment -n roboshop
# - Check rollout status:
#   kubectl rollout status deployment/nginx-deployment -n roboshop
# - View logs (follow):
#   kubectl logs -f <pod-name> -n roboshop
# - Port-forward to deployment:
#   kubectl port-forward deployment/nginx-deployment 8080:80 -n roboshop
# - Delete & recreate deployment (if selector changed):
#   kubectl delete deployment nginx-deployment -n roboshop && kubectl apply -f d:\kubernetes\k8-resources\sets\02-deployment.yaml -n roboshop
# ...existing code...
# Notes:
# - The Deployment creates a ReplicaSet which in turn creates Pods using the template above.
# - Changing spec.template (e.g., image) triggers a rolling update by default.
# - Ensure selector.matchLabels exactly equals template.metadata.labels; mismatch prevents the Deployment from managing the Pods.
# - For production, add resources.requests/limits and imagePullPolicy, and pin the image tag.
#
# Important kubectl commands (run with -n roboshop if using that namespace):
# - Apply/update manifest:
#   kubectl apply -f d:\kubernetes\k8-resources\sets\02-deployment.yaml -n roboshop
# - Describe deployment:
#   kubectl describe deployment nginx-deployment -n roboshop
# - List deployments:
#   kubectl get deployments -n roboshop
# - List pods for this app:
#   kubectl get pods -l app=nginx -n roboshop
# - Delete a pod (Deployment will recreate):
#   kubectl delete pod <pod-name> -n roboshop
# - Delete pods by label:
#   kubectl delete pods -l componet=frontend -n roboshop
# - Trigger rolling restart:
#   kubectl rollout restart deployment/nginx-deployment -n roboshop
# - Check rollout status:
#   kubectl rollout status deployment/nginx-deployment -n roboshop
# - View logs (follow):
#   kubectl logs -f <pod-name> -n roboshop
# - Port-forward to deployment:
#   kubectl port-forward deployment/nginx-deployment 8080:80 -n roboshop
# - Delete & recreate deployment (if selector changed):
#   kubectl delete deployment nginx-deployment -n roboshop && kubectl apply -f d:\kubernetes\k8-resources\sets\02-deployment.yaml -n roboshop